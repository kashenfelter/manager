<html lang="en">
  <head>
    <title>Tasks</title>

  </head>

  <body>

          <div class="layer tile" data-force="30">
            <div class="tile__name">Assigned</div>
            <div class="tile__list" id="list1">
              <% @assigned.each do |o|%>
                <% @current_task=o %>
                <%= render partial: "writer_task" %>
              <% end%>
            </div>
          </div>
          <div class="layer tile" data-force="30">
            <div class="tile__name">To Do</div>
            <div class="tile__list" id="list2">
                <% @to_do.each do |o|%>
                    <% @current_task=o %>
                    <%= render partial: "writer_task" %>
                 <%end%>
            </div>
          </div>


          <div class="layer tile" data-force="30">
            <div class="tile__name">Doing</div>
            <div class="tile__list" id="list3">
             <% @doing.each do |o|%>
               <% @current_task=o %>
               <%= render partial: "writer_task" %>
             <% end%>
            </div>
          </div>

          <div class="layer tile" data-force="30">
            <div class="tile__name">Done</div>
            <div class="tile__list" id="list4">
             <% @done.each do |o|%>
               <% @current_task=o %>
               <%= render partial: "writer_task" %>
             <% end%>
            </div>
          </div>
<style>
  #div1, #div2, #div3 {backgorund:transparent;border:2px dashed black;height:75px;width:292px;}
</style>

<%= javascript_include_tag 'updateStatus' %>
<script>

function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev, target) {
    ev.preventDefault();
    var data = ev.dataTransfer.getData("text");
    ev.target.appendChild(document.getElementById(data));
    var status;
    if(target.id == "div1") {
        status=2;
    }
    else if (target.id == "div2") {
        status=1;
    }
    else if (target.id == "div3") {
        status=0;
    }
    var params = "{'id':"+data + ",'status':"+status+"}";
    params=params.replace(/'/g, '"');
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.open("Content-length", params.length);
    xmlHttp.open("Connection", "close");
    xmlHttp.open( "Put", '<%=tasks_updateStatus_url%>' , true );
    xmlHttp.send( params );
}

</script>


  </body>
</html>
