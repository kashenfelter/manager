<html lang="en">
  <head>
    <title>Tasks</title>
  </head>

  <body>
    <div class="container tasks-queue">
      <!-- Example row of columns -->
      <div class="row">
        <div class="col-md-3 op-title-bg-left">
          <h2 class="op-title">Assigned</h2>
        </div>
        <div class="col-md-3 op-title-bg-left">
          <h2 class="op-title">To-Do</h2>
        </div>
        <div class="col-md-3 op-title-bg-middle">
          <h2 class="op-title">In Progress</h2>
        </div>
        <div class="col-md-3 op-title-bg-right">
          <h2 class="op-title">Done</h2>
        </div>
        <div class="row-2">
          <div class="col-md-3" style="visibility:hidden;"></div>
          <div class="col-md-3 op-body-bg-left" id="div1" ondrop="drop(event, this)" ondragover="allowDrop(event)"><h4 class="op-title">Drop Task Here to Accept</h4></div>
          <div class="col-md-3 op-body-bg-middle" id="div2" ondrop="drop(event, this)" ondragover="allowDrop(event)"><h4 class="op-title">Drop Task Here While in Progress</h4></div>
          <div class="col-md-3 op-body-bg-right" id="div3" ondrop="drop(event, this)" ondragover="allowDrop(event)"><h4 class="op-title">Drop Task Here When Done</h4></div>
        </div>
        <div class="row-2">
          <div class="col-md-3 op-body-bg-left">
              <% @assigned.each do |o|%>
                <% @current_task=o %>
                <%= render partial: "writer_task" %>
              <% end%>
         </div>

          <div class="col-md-3">
              <% @to_do.each do |o|%>
                <% @current_task=o %>
                <%= render partial: "writer_task" %>
              <% end%>
         </div>

         <div class="col-md-3">
             <% @doing.each do |o|%>
               <% @current_task=o %>
               <%= render partial: "writer_task" %>
             <% end%>
         </div>
         <div class="col-md-3">
             <% @done.each do |o|%>
               <% @current_task=o %>
               <%= render partial: "writer_task" %>
             <% end%>
         </div>
       </div>
     </div>
    </div>

<style>
  #div1, #div2, #div3 {backgorund:transparent;border:2px dashed black;height:75px;width:292px;}
</style>


<script>

function allowDrop(ev) {
    ev.preventDefault();
}

function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev, target) {
    ev.preventDefault();
    var data = ev.dataTransfer.getData("text");
    ev.target.appendChild(document.getElementById(data));
    var status;
    if(target.id == "div1") {
        status=2;
    }
    else if (target.id == "div2") {
        status=1;
    }
    else if (target.id == "div3") {
        status=0;
    }
    var params = "{'id':"+data + ",'status':"+status+"}";
    params=params.replace(/'/g, '"');
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open("Content-Type", "application/x-www-form-urlencoded");
    xmlHttp.open("Content-length", params.length);
    xmlHttp.open("Connection", "close");
    xmlHttp.open( "Put", '<%=tasks_updateStatus_url%>' , true );
    xmlHttp.send( params );
}

</script>


  </body>
</html>
